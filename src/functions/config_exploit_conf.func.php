<?php

################################################################################
#SETUP TO RUN COMMANDS IN ID####################################################
################################################################################
function __configExploitsExec($id, $alvo) {

    $resultadoURL = __configExploitsList();
    $final = [];
    $id_ = ((strstr($id, ','))) ? explode(',', $id) : [$id]; // MULTIPLAS ID'S EXPLOITS
    foreach ($resultadoURL as $key):
        $__key = strstr($key, '::') ? explode("\n", $key) : NULL;
        $final = is_array($__key) ? array_merge($final, $__key) : $final;
    endforeach;
    foreach ($id_ as $value):
        $final__ = !is_null($value) ? explode('::', $final[$value]) : NULL;
        $barra = "{$_SESSION["c1"]}[ INFO ]|___{$_SESSION["c0"]}\n";
        $barra.= "      {$_SESSION["c1"]}|";
        print !is_null($final__) ? "\n{$barra}[ EXPLOIT ]:: {$final__[0]} /[ ID ]:: {$value} /[ COMMAND ]:: " . $final__[1] : NULL;
        echo "\n      ------------------------------------------------------------------------------------------------------------------";
        print !is_null($final__) ? __command($final__[1], $alvo) : NULL;
        __plus();
    endforeach;
}

################################################################################
#LIST COMMANDS FILE exploits.conf###############################################
################################################################################
function __configExploitsList($op = NULL) {

    $resultadoURL = array_unique(array_filter(explode("\n", file_get_contents($_SESSION['config']['file_exploit_conf']))));
    if (!is_null($op)):
        echo __bannerlogo();
        echo "{$_SESSION["c11"]}[*]__\n";
        echo "     |MENU EXPLOITS:";
        echo "\n     |ID TYPE_EXPLOIT::EXPLOIT_COMMAND";
        echo "\n     |FILE CONFIG: {$_SESSION['config']['file_exploit_conf']}";
        echo "\n     |USE COMMAND EX: --exploit-id '1,2,3,19'";
        echo "\n ---------------------------------------------------------------------------------------------------------------------\n";
        __getOut($resultadoURL);
        __getOut("{$_SESSION['config']['line']}\n");
        __plus();
    else:
        return is_array($resultadoURL) ? $resultadoURL : NULL;
    endif;
}